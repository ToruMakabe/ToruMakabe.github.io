<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Openstack &middot; re-imagine</title>

    <meta name="description" content="my life is the sum of my imagination">

    <meta name="generator" content="Hugo 0.14" />
    <meta name="twitter:card" content="summary">
    
    <meta name="twitter:title" content="Openstack &middot; re-imagine">
    <meta name="twitter:description" content="my life is the sum of my imagination">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Openstack &middot; re-imagine">
    <meta property="og:description" content="my life is the sum of my imagination">

    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Oxygen:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-old-ie-min.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">
    <!--<![endif]-->

    <link rel="stylesheet" href="http://torumakabe.github.io//css/all.min.css">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

    <link rel="alternate" type="application/rss+xml" title="re-imagine" href="http://torumakabe.github.io//index.xml" />
</head>
<body>


<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
    <div class="header">
        <hgroup>
            <h1 class="brand-title"><a href="http://torumakabe.github.io/">re-imagine</a></h1>
            <h2 class="brand-tagline"> my life is the sum of my imagination </h2>
        </hgroup>

        <nav class="nav">
            <ul class="nav-list">
                
                <li class="nav-item">
                    <a class="pure-button" href="https://twitter.com/tmak_tw"><i class="fa fa-twitter"></i> Twitter</a>
                </li>
                
                
                <li class="nav-item">
                    <a class="pure-button" href="https://github.com/ToruMakabe "><i class="fa fa-github-alt"></i> github</a>
                </li>
                
                <li class="nav-item">
                    <a class="pure-button" href="http://torumakabe.github.io//index.xml"><i class="fa fa-rss"></i> rss</a>
                </li>
            </ul>
        </nav>
    </div>
</div>


    <div class="content pure-u-1 pure-u-md-3-4">
        <div>
            
            <div class="posts">
                
                <h1 class="content-subhead">04 Apr 2015, 00:00</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="http://torumakabe.github.io/post/terraform-openstack-minimum/" class="post-title">いきなり Terraform OpenStack Provider</a>

                        <p class="post-meta">
                            
                            
                        </p>
                    </header>

                    <div class="post-description">
                        

<h3 id="terraform-0-4でopenstack-providerリリース:5f9dbf3eb73e084c7453e28119859d69">Terraform 0.4でOpenStack Providerリリース</h3>

<p>以前からOpenStack対応は表明されていたのですが、いよいよ<a href="https://hashicorp.com/blog/terraform-0-4.html">v0.4</a>でリリースされました。</p>

<h3 id="小さくはじめましょう:5f9dbf3eb73e084c7453e28119859d69">小さくはじめましょう</h3>

<p>この手のツールを試すときは、はじめから欲張ると苦労します。最小限の設定でひとまず動かすとクイックに幸せが訪れます。目標は10分。</p>

<h3 id="テストした環境:5f9dbf3eb73e084c7453e28119859d69">テストした環境</h3>

<ul>
<li>Terraform 0.4</li>
<li>Mac OS 10.10.2</li>
<li>HP Helion Public Cloud</li>
</ul>

<h3 id="openstackerのみだしなみ-環境変数:5f9dbf3eb73e084c7453e28119859d69">OpenStackerのみだしなみ、環境変数</h3>

<p>下記、環境変数はセットされてますよね。要確認。</p>

<ul>
<li>OS_AUTH_URL<br /></li>
<li>OS_USERNAME<br /></li>
<li>OS_PASSWORD<br /></li>
<li>OS_REGION_NAME<br /></li>
<li>OS_TENANT_NAME<br /></li>
</ul>

<h3 id="最小限の構成ファイル:5f9dbf3eb73e084c7453e28119859d69">最小限の構成ファイル</h3>

<p><script type="text/javascript" src="http://gist.github.com/977209064bcfda66d085.js"></script></p>

<p>これだけ。Providerの設定は書かなくていいです。Terraformは環境変数を見に行きます。Resource部は、最小限ということで、まずはインスタンスを起動し、Floating IPをつけるとこまで持っていきましょう。</p>

<h3 id="さあ実行:5f9dbf3eb73e084c7453e28119859d69">さあ実行</h3>

<p>まずはterraform planコマンドで、実行計画を確認します。</p>

<pre><code>$ terraform plan
Refreshing Terraform state prior to plan...


The Terraform execution plan has been generated and is shown below.
Resources are shown in alphabetical order for quick scanning. Green resources
will be created (or destroyed and then created if an existing resource exists), yellow resources are being changed in-place, and red resources will be destroyed.

Note: You didn't specify an &quot;-out&quot; parameter to save this plan, so when &quot;apply&quot; is called, Terraform can't guarantee this is what will execute.

+ openstack_compute_instance_v2.sample-server
    access_ip_v4:      &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;
    access_ip_v6:      &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;
    flavor_id:         &quot;&quot; =&gt; &quot;my_flavor_id&quot;
    flavor_name:       &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;
    floating_ip:       &quot;&quot; =&gt; &quot;aaa.bbb.ccc.ddd&quot;
    image_id:          &quot;&quot; =&gt; &quot;my_image_id&quot;
    image_name:        &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;
    key_pair:          &quot;&quot; =&gt; &quot;my_keypair&quot;
    name:              &quot;&quot; =&gt; &quot;tf-sample&quot;
    network.#:         &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;
    region:            &quot;&quot; =&gt; &quot;my_region&quot;
    security_groups.#: &quot;&quot; =&gt; &quot;1&quot;
    security_groups.0: &quot;&quot; =&gt; &quot;my_sg&quot;
</code></pre>

<p>定義通りに動きそうですね。では実行。applyです。</p>

<pre><code>$ terraform apply  
openstack_compute_instance_v2.sample-server: Creating...  
    access_ip_v4:      &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;  
    access_ip_v6:      &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;  
    flavor_id:         &quot;&quot; =&gt; &quot;my_flavor&quot;  
    flavor_name:       &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;  
    floating_ip:       &quot;&quot; =&gt; &quot;aaa.bbb.ccc.ddd&quot;  
    image_id:          &quot;&quot; =&gt; &quot;my_image_id&quot;  
    image_name:        &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;  
    key_pair:          &quot;&quot; =&gt; &quot;my_keypair&quot;  
    name:              &quot;&quot; =&gt; &quot;tf-sample&quot;  
    network.#:         &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;  
    region:            &quot;&quot; =&gt; &quot;my_region&quot;
    security_groups.#: &quot;&quot; =&gt; &quot;1&quot;
    security_groups.0: &quot;&quot; =&gt; &quot;my_sg&quot;
openstack_compute_instance_v2.test-server: Creation complete

Apply complete! Resources: 1 added, 0 changed, 0 destroyed.

The state of your infrastructure has been saved to the path below. This state is required to modify and destroy your infrastructure, so keep it safe. To inspect the complete state use the `terraform show` command.
</code></pre>

<p>とても楽ちんですね。あとはオプションを追加して込み入った構成に挑戦してみてください。</p>

                    </div>
                </section>
                
                <h1 class="content-subhead">12 Dec 2014, 00:00</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="http://torumakabe.github.io/post/monasca/" class="post-title">君はOpenStack Monascaを知っているか</a>

                        <p class="post-meta">
                            
                            
                        </p>
                    </header>

                    <div class="post-description">
                        

<p>このエントリーは、<a href="http://www.adventar.org/calendars/602">OpenStack (2枚目) Advent Calendar 2014</a>の12夜目担当作品です。</p>

<h3 id="monitoring-as-a-service:a2dc20a10b2175cd92893d87c6bb4e06">Monitoring as a Service</h3>

<p>監視をサービスとして提供するって、どういうことでしょうか。</p>

<p>[Monitoring]<br />
従来の監視。担当者が事前に監視項目を定義する。静的。</p>

<p>[Monitoring as a Service]
監視機能をサービスとして提供する。不特定多数のユーザーが、自分の監視したい測定項目を定義し、自分の好きなタイミングでチェックする。GUIはもちろん、APIでデータ取得できる。動的。</p>

<p>まあ、AWSのCloudWatchみたいなものです。先に言うべきでしたね、すいません。</p>

<p>このMonitoring as a Service、技術的なハードルは結構高いんです。刻々と上がってくるイベントをさばき、蓄積し、APIをバシバシ叩くユーザーリクエストに応えなきゃいけない。監視というと裏方のイメージがありますが、これは、対価をいただくに値する、立派なサービスです。</p>

<p>そこでOpenStackのMonitoring as a Service事情はどうでしょうか。一見、それを実現できそうなCeilometerがあります。ただ、もともとCeilomerは課金のための利用情報収集をする、という生まれなので、マルチテナントで、ユーザーが自らメトリックを定義し、チェックするという使い方に向いていません。ユーザー向けというより、管理者向けなんです。</p>

<p>そこで<a href="https://wiki.openstack.org/wiki/Monasca">Monasca</a>の登場です。まだ正式機能ではありませんが、いずれ昇格するのでは、と個人的に期待しています。</p>

<p>では、アーキテクチャーを見てみましょう。<br />
<img src="https://wiki.openstack.org/w/images/4/4a/Monasca-arch-component-diagram.png" alt="MonascaArc" />
</p>

<p>ひゃー、ワクワクしますがちょっと重いですね。特にイベントを処理するメッセージキュー、イベントを貯めるDBは工夫が要りそうです。現時点で、キューにはApache Kafka、DBにはカラムナーDBのVerticaや、時系列DBのInflux DBがサポートされています。正直、無理目のスタックです。</p>

<p>と思っていたら。</p>

<p>なんと、<a href="https://github.com/stackforge/monasca-vagrant">Monasca-Vagrant</a>なんてものができているじゃありませんか。VagrantとAnsibleでサクっと環境を作れるとな。まじか。本当か。本当だった。1時間くらいでできた。</p>

<h3 id="気をつけること:a2dc20a10b2175cd92893d87c6bb4e06">気をつけること</h3>

<ul>
<li>動作実績のあるわたしの環境は、MacBook Pro Late 2013 / 2.3 GHz Intel Core i7、メモリ16GB、Yosemite。</li>
<li>Vagrantfileを見る限り、メモリ7GBと6GBのVMを作る。ここいじって動くかは要検証。</li>
<li>git cloneしたディレクトリ直下にansibleのrequirementファイルが置かれるので、そこで作業</li>
<li>vagrant upで2つのVM、devstackとmini-monが作られる、ここは時間と帯域がいるので、スタバな人は要注意</li>
</ul>

<p>気をつけるのはこれくらいです。レッツトライ。</p>

<p>年末年始休暇のお楽しみが増えましたね。</p>

<p>これでわたしの2014年Advent Calendarシリーズは完了です。メリークリスマス &amp; 良いお年を。</p>

                    </div>
                </section>
                
                <h1 class="content-subhead">09 Dec 2014, 00:00</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="http://torumakabe.github.io/post/longtermsupport/" class="post-title">OpenStackと長期バージョン固定</a>

                        <p class="post-meta">
                            
                            
                        </p>
                    </header>

                    <div class="post-description">
                        

<p>このエントリーは、<a href="http://www.adventar.org/calendars/602">OpenStack (2枚目) Advent Calendar 2014</a>の9夜目担当作品です。</p>

<h3 id="ソフトウェア-バージョン-サポート:e4bf6752a3e6bdd894e5fbbe3136fda0">ソフトウェア、バージョン、サポート</h3>

<p>たいていのソフトウェアには、バージョンがあります。そしてそれぞれのソフトウェアには「直近2バージョンをサポートする。ユーザーがそれよりも古いバージョンを使いたい場合、ベストエフォートで対応する。サポート対象外のバージョンで不具合対応ができるかどうかは、場合による。」なんていうポリシーがあったりします。</p>

<h3 id="進化著しいソフト-openstackでは:e4bf6752a3e6bdd894e5fbbe3136fda0">進化著しいソフト、OpenStackでは</h3>

<p>OpenStackは現在、半年ごとにアップデートします。進化が早いです。そして<a href="https://wiki.openstack.org/wiki/Releases">公式サイト</a>を見て分かるとおり、直近2バージョンがサポート対象です。ちょっと短いですね。長期サポートよりも新規開発を優先しているわけですが、「もうちょっと長くサポートしてくれんか」というのが人情でしょう。</p>

<h3 id="でも-長期バージョン固定するとどうなるか:e4bf6752a3e6bdd894e5fbbe3136fda0">でも、長期バージョン固定するとどうなるか</h3>

<p>では仮に「そのバージョンがリリースされてから3年間、同じバージョンで運用する」というポリシーでクラウドを作ったとしましょう。その間に、5〜6バージョン、進化してしまうわけですが。以下、ちょっと未来の想像です。</p>

<p>[とあるクラウド その1]<br />
- (Dev)  今度のシステムでAっちゅうライブラリ使いたいんだけど、OpenStackだと、サポートがLからなんだよね。<br />
- (Ops) あー、うちの環境Jよ。<br />
- (Dev) そうすか。じゃあ他のにするわ。</p>

<p>使われないクラウド。悲しい。これからOpenStackに対応したアプリやライブラリ、たくさん出てきそうなのに。</p>

<p>[とあるクラウド その2]<br />
- (Ops) うちはJで3年間バージョン固定、長期サポートです!! アップデート作業のために環境を止めたりしません!!<br />
- (Dev) おーいいね。決定。3年のんびりするわ。<br />
〜3年後〜<br />
- (Ops) 約束の3年です。長年放置したのでバージョンアップは大手術です。システム止めます!!<br />
- (Dev) いやいやいやいや、アプリも運用も、そんな準備できてないし。</p>

<p>リスクの先送りと大噴火。「小さな変更をこまめに行い、リスクを最小化する。人もプロセスも、アプリの作りも、変化に強くなる。」という、最近のDevOpsなりCI/CDといったトレンドとは逆のやり口です。</p>

<h3 id="アップデートの仕組みに投資したほうが建設的と思う:e4bf6752a3e6bdd894e5fbbe3136fda0">アップデートの仕組みに投資したほうが建設的と思う</h3>

<p>もちろん、OpenStackの開発が落ち着いてきたら、長期のバージョン固定サポートは価値が高いと思います。ただし、イノベーションを求めて活発に開発しているソフトでは、結局それはユーザーにとって不利益になるのではないでしょうか。</p>

<p>それよりは、アップデーターの開発、複数コントロールプレーンの平行運用の確立、アプリや運用でも対応するなど、「変化を受け入れる」ほうが建設的なのではと考える次第です。</p>

<p>最後に、<a href="http://superuser.openstack.org/articles/openstack-user-survey-insights-november-2014">最新のOpenStack User Survey</a>を紹介します。注目はBusiness Driverです。OpenStackを使う、動機です。</p>

<p>OpenStackのBusiness Driverとして、最もユーザーが重視しているのは、&rdquo;Ability to innovate&rdquo;なんですよね。
あまり変化なく、3年とか5年とか、言葉は悪いですが、塩漬けで使うような従来型システムとは、優先すべきところが違うのではなかろうかと。</p>

<p>メインフレームから、クライアント/サーバー、そしてWebと、テクノロジーリフレッシュの機会が、これまではありました。そろそろ、リフレッシュしてみませんか。</p>

                    </div>
                </section>
                
                <h1 class="content-subhead">06 Dec 2014, 00:00</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="http://torumakabe.github.io/post/handsome-openstack/" class="post-title">ハンサムOpenStack</a>

                        <p class="post-meta">
                            
                            
                        </p>
                    </header>

                    <div class="post-description">
                        

<p>このエントリーは、<a href="http://www.adventar.org/calendars/602">OpenStack (2枚目) Advent Calendar 2014</a>の6夜目担当作品です。</p>

<h3 id="出オチ:69265e72de8632f3d558928e3a79ce26">出オチ</h3>

<p>OpenStackも人気が出て、Advent Calendarが1枚ではおさまさなくなりました。2枚目です。ハンサムです。だからハンサムOpenStackです。</p>

<p>こんなテーマで何か書けるんでしょうか? 何をおっしゃる、芸術とは制約から生まれるのです。</p>

<h3 id="そもそも2枚目とは:69265e72de8632f3d558928e3a79ce26">そもそも2枚目とは</h3>

<pre><code>「二枚目」という用語は、歌舞伎用語をもとに、江戸時代に生まれた。歌舞伎の看板は、通常は8枚から成っていた。一枚目の看板は「書き出し」と言われ、主役の名が書かれ、二枚目の看板には若い色男の役者の名が書かれることになっていた。また、三枚目の看板には道化役の名が書かれることになっていた。
</code></pre>

<p><a href="http://ja.wikipedia.org/wiki/%E4%BA%8C%E6%9E%9A%E7%9B%AE">「二枚目」（2013年5月28日 (火) 02:17 UTCの版）『ウィキペディア日本語版』</a></p>

<h3 id="8枚あるらしいぞ-いじってみよう:69265e72de8632f3d558928e3a79ce26">8枚あるらしいぞ いじってみよう</h3>

<ul>
<li><p>一枚目：主役：そのまま主役。「一枚看板」という用法もある。<br />
<em>Novaですね。主役です。</em></p></li>

<li><p>二枚目：色男：優男で色事担当<br />
<em>これはあとにとっておきましょう。</em></p></li>

<li><p>三枚目：道化：お笑い担当<br />
<em>Glanceですね。何も変なことしてないのにネタにされる。</em></p></li>

<li><p>四枚目：中軸：中堅役者　まとめ役<br />
<em>Cinderでしょうか。主役のNovaを活かす名脇役。</em></p></li>

<li><p>五枚目：敵役：一般的な敵役<br />
<em>Heatかな。はじめのCloudFormation形式ってのが気に入らなかった。HOTが出てきたので許す。</em></p></li>

<li><p>六枚目：実敵：憎めない善要素のある敵役<br />
<em>Ceilometerです。重いです。絶賛チューニング中です。</em></p></li>

<li><p>七枚目：実悪：巨悪　ラスボス　全ての悪事の黒幕<br />
<em>Neutron。でもまあ、Neutronに罪はないか。取り巻きが良くなかったのよきっと。これから良くなるよ。</em></p></li>

<li><p>八枚目：座長：元締め<br />
<em>Swiftで決まり。ほとばしる安定感。というかAWSに依存したS3互換製品とかやめてみんなオープンなSwift互換にするといいよ。</em></p></li>
</ul>

<h3 id="じゃあ二枚目は:69265e72de8632f3d558928e3a79ce26">じゃあ二枚目は?</h3>

<p>*Trove*です。若さと期待の大きさを込めてキャスティングしました。というか<a href="http://www.publickey1.jp/blog/14/paasdbaasapaas12amazonidc_japan.html">これ</a>を見ても分かるとおり、当面PaaSと言えばDBaaSです。DBの構築とか運用面倒ですものね。Troveはレプリケーション機能が追加されたり、いよいよこれから本格化と思います。</p>

<p>2枚目のカレンダーなので、ネタ感あふれる副音声モードでお届けしました。ではメリークリスマス。</p>

                    </div>
                </section>
                
                <h1 class="content-subhead">14 Sep 2014, 00:00</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="http://torumakabe.github.io/post/openstack-tools/" class="post-title">OpenStackのツール環境をImmutableに整える</a>

                        <p class="post-meta">
                            
                            
                        </p>
                    </header>

                    <div class="post-description">
                        

<h3 id="タイトルは釣りです:06c978f415868c5d089a8460c0068f0d">タイトルは釣りです</h3>

<p>すいません。でも、日本のどこかに、わたしを待ってる、理解し合える人がいらっしゃると思います。</p>

<h3 id="なぜ必要か:06c978f415868c5d089a8460c0068f0d">なぜ必要か?</h3>

<p>いけてるOpenStackerは、相手にするOpenStack環境がオンプレであろうがパブリッククラウドであろうが、すぐにコマンド叩いて「なるほどこの環境は。。。ニヤリ」とできるものです。そういうものです。</p>

<h3 id="やりたいこと:06c978f415868c5d089a8460c0068f0d">やりたいこと</h3>

<ul>
<li>OpenStack CLIなどのツールを詰め込んだ環境を、必要な時に、すぐ使いたい・作りたい</li>
<li>Windows、Macどちらでも同様の環境にしたい</li>
<li>相手にするOpenStackがオンプレでも、パブリッククラウドでも、また、ツールがぶら下がっているネットワーク環境の違いも、設定やスクリプトで吸収</li>
<li>Windows、Mac環境を汚さない、また、汚されない</li>
<li>コマンド2、3発程度で、気軽に作って消せる</li>
<li>VMできたらすぐログイン、即OpenStack CLIが使える</li>
</ul>

<h3 id="方針:06c978f415868c5d089a8460c0068f0d">方針</h3>

<ul>
<li>OpenStackの各種ツールを動かすOSはLinuxとし、VM上に作る</li>
<li>VagrantでWindows/Macの違いを吸収する</li>
<li>VMイメージをこねくり回さず、常にまっさらなベースOSに対し構成管理ツールでプロビジョニングを行う</li>
<li>構成管理ツールはAnsibleを使う(本を買ったので、使いたかっただけ)</li>
</ul>

<h3 id="前提条件:06c978f415868c5d089a8460c0068f0d">前提条件</h3>

<ul>
<li>Windows 8.1 &amp; VMware Worksation 10.0.3</li>
<li>OSX 10.9.4 &amp; VirtualBox 4.3.16</li>
<li>Vagrant 1.6.5  (VMware用ライセンス買いました)</li>
<li>ひとまずOpenStack CLIを使えるところまで作る</li>
</ul>

<h3 id="ではvagrantfileを見てみましょう:06c978f415868c5d089a8460c0068f0d">ではVagrantfileを見てみましょう</h3>

<p><script type="text/javascript" src="http://gist.github.com/a470e86a1477cd76d4f4.js"></script></p>

<p>これがわたしが作ったVagrantfileです。見ての通りですが、以下に補足します。</p>

<ul>
<li>VMwareとVirtualBoxでなるべく環境を合わせるため、opscodeの<a href="https://github.com/opscode/bento">Bento</a>で、事前にboxファイルを作ってます。ubuntu14.04としました。</li>
<li>実行ディレクトリにprovision.shを置きます。</li>
<li>provision.shでubuntuへansibleをインストールし、追って入れたてホヤホヤのansibleで環境を整えます。</li>
<li>実行ディレクトリ内のansibleディレクトリに、ansibleのplaybook(site.yml)と変数定義ファイル(vars/env.yml)を置きます。</li>

<li><p>hostsファイルには以下のようにlocalhostを定義します。</p>

<p>[localhost]<br />
127.0.0.1 ansible_connection=local</p></li>
</ul>

<h4 id="provision-sh解説:06c978f415868c5d089a8460c0068f0d">provision.sh解説</h4>

<p><script type="text/javascript" src="http://gist.github.com/57ae9f8edbe6cf30cd16.js"></script></p>

<p>ansibleのインストールとplaybookの実行。playbookの実行が回りくどい感じなのは、Vagrantのフォルダ同期機能でパーミッションが正しく設定できなかったゆえのワークアラウンドです。</p>

<h4 id="playbook-site-yml-解説:06c978f415868c5d089a8460c0068f0d">playbook(site.yml)解説</h4>

<p><script type="text/javascript" src="http://gist.github.com/6c5d8ae296948b8d4070.js"></script></p>

<ul>
<li><p>varsディレクトリ配下に、環境変数を定義したenv.ymlを置きます。ここで対象のOpenStack環境を指定します。</p>

<p>OS_TENANT_NAME: your_tenant_name<br />
OS_USERNAME: your_username<br />
&hellip;.</p></li>
</ul>

<p>という感じで並べてください。.bashrcに追加されます。
- タイムゾーンをAsia/Tokyoにします。
- 必要なパッケージ、pipの導入後、OpenStack CLI群をインストールします。</p>

<h3 id="windowsでの実行例:06c978f415868c5d089a8460c0068f0d">Windowsでの実行例</h3>

<p>Vagrant &amp; AnsibleはMacの情報が多いので、ここではWindowsでの実行例を。PowerShellを管理者権限で起動し、Vagrantfileやprovision.sh、ansible関連ファイルが住むディレクトリでvagrant up。</p>

<pre><code>PS C:\Users\hoge&gt; vagrant up
Bringing machine 'default' up with 'vmware_workstation' provider...
==&gt; default: Cloning VMware VM: 'opscode-ubuntu1404'. This can take some time...
(snip)
==&gt; default: TASK: [install OpenStack CLIs] ************************************************
==&gt; default: changed: [127.0.0.1] =&gt; (item=python-neutronclient)
==&gt; default: changed: [127.0.0.1] =&gt; (item=python-novaclient)
==&gt; default: changed: [127.0.0.1] =&gt; (item=python-cinderclient)
==&gt; default: changed: [127.0.0.1] =&gt; (item=python-keystoneclient)
==&gt; default: changed: [127.0.0.1] =&gt; (item=python-swiftclient)
==&gt; default: changed: [127.0.0.1] =&gt; (item=python-keystoneclient)
==&gt; default: changed: [127.0.0.1] =&gt; (item=python-glanceclient)
==&gt; default: changed: [127.0.0.1] =&gt; (item=python-troveclient)
==&gt; default: changed: [127.0.0.1] =&gt; (item=python-designateclient)
==&gt; default:
==&gt; default: PLAY RECAP ********************************************************************
==&gt; default: 127.0.0.1                  : ok=8    changed=7    unreachable=0    failed=0
</code></pre>

<p>うまく動いたようです。</p>

<pre><code>PS C:\Users\hoge&gt; vagrant ssh
cygwin warning:
  MS-DOS style path detected: C:/Users/hoge/.vagrant.d/insecure_private_key
  Preferred POSIX equivalent is: /cygdrive/c/Users/hoge/.vagrant.d/insecure_private_key
  CYGWIN environment variable option &quot;nodosfilewarning&quot; turns off this warning.
  Consult the user's guide for more details about POSIX paths:
    http://cygwin.com/cygwin-ug-net/using.html#using-pathnames
Welcome to Ubuntu 14.04 LTS (GNU/Linux 3.13.0-24-generic x86_64)

 * Documentation:  https://help.ubuntu.com/
Last login: Sun Apr 20 02:21:46 2014 from 172.16.230.1
</code></pre>

<p>vagrant sshでサクッとログイン。ちなみに、これだけのためにcygwin入れてます。負けは認めます。</p>

<pre><code>vagrant@vagrant:~$ nova list
+----+------+--------+------------+-------------+----------+
| ID | Name | Status | Task State | Power State | Networks |
+----+------+--------+------------+-------------+----------+
+----+------+--------+------------+-------------+----------+
</code></pre>

<p>いきなりnovaコマンド使えます。</p>

<p>なおproxy環境下では、/etc/apt/apt.conf、.bashrcやplaybookにproxy設定をするよう、provision.shとplaybook(site.yml)をいじれば動くと思います。まだやってませんが。</p>

                    </div>
                </section>
                
            </div>
            
<div class="pagination">
  <nav role="pagination" class="post-list-pagination">
      
    <span class="post-list-pagination-item post-list-pagination-item-current">Page 1 of 3</span>
    
      <a href="/tags/openstack/page/2/" class="post-list-pagination-item pure-button post-list-pagination-item-next">
        Older&nbsp;<i class="fa fa-angle-double-right"></i>
      </a>
    
  </nav>
</div>


            <div class="footer">
    <div class="pure-menu pure-menu-horizontal pure-menu-open">
        <ul>
            <li>Powered by <a class="hugo" href="http://hugo.spf13.com/" target="_blank">hugo</a></li>
        </ul>
    </div>
</div>
<script src="http://torumakabe.github.io//js/all.min.js"></script>
        </div>
    </div>
</div>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', '', 'auto');
ga('send', 'pageview');

</script>

</body>
</html>
