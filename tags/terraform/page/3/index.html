<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terraform &middot; re-imagine</title>

    <meta name="description" content="my life is the sum of my imagination">

    <meta name="generator" content="Hugo 0.39" />
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="tmak_tw" />
    <meta name="twitter:title" content="Terraform &middot; re-imagine">
    <meta name="twitter:description" content="my life is the sum of my imagination">

    <meta property="og:type" content="article">
    <meta property="og:title" content="Terraform &middot; re-imagine">
    <meta property="og:description" content="my life is the sum of my imagination">

    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Oxygen:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-old-ie-min.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">
    <!--<![endif]-->

    <link rel="stylesheet" href="https://ToruMakabe.github.io//css/all.min.css">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

    <link rel="alternate" type="application/rss+xml" title="re-imagine" href="https://ToruMakabe.github.io//index.xml" />
</head>
<body>


<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
    <div class="header">
        <hgroup>
            <h1 class="brand-title"><a href="https://ToruMakabe.github.io/">re-imagine</a></h1>
            <h2 class="brand-tagline"> my life is the sum of my imagination </h2>
        </hgroup>

        <nav class="nav">
            <ul class="nav-list">
                
                <li class="nav-item">
                    <a class="pure-button" href="https://twitter.com/tmak_tw"><i class="fa fa-twitter"></i> Twitter</a>
                </li>
                
                
                <li class="nav-item">
                    <a class="pure-button" href="https://github.com/ToruMakabe "><i class="fa fa-github-alt"></i> github</a>
                </li>
                
                <li class="nav-item">
                    <a class="pure-button" href="https://ToruMakabe.github.io//index.xml"><i class="fa fa-rss"></i> rss</a>
                </li>
            </ul>
        </nav>
    </div>
</div>


    <div class="content pure-u-1 pure-u-md-3-4">
        <div>
            
            <div class="posts">
                
                <h1 class="content-subhead">04 Apr 2015, 00:00</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="https://ToruMakabe.github.io/post/terraform-openstack-minimum/" class="post-title">いきなり Terraform OpenStack Provider</a>

                        <p class="post-meta">
                            
                            
                        </p>
                    </header>

                    <div class="post-description">
                        

<h3 id="terraform-0-4でopenstack-providerリリース">Terraform 0.4でOpenStack Providerリリース</h3>

<p>以前からOpenStack対応は表明されていたのですが、いよいよ<a href="https://hashicorp.com/blog/terraform-0-4.html">v0.4</a>でリリースされました。</p>

<h3 id="小さくはじめましょう">小さくはじめましょう</h3>

<p>この手のツールを試すときは、はじめから欲張ると苦労します。最小限の設定でひとまず動かすとクイックに幸せが訪れます。目標は10分。</p>

<h3 id="テストした環境">テストした環境</h3>

<ul>
<li>Terraform 0.4</li>
<li>Mac OS 10.10.2</li>
<li>HP Helion Public Cloud</li>
</ul>

<h3 id="openstackerのみだしなみ-環境変数">OpenStackerのみだしなみ、環境変数</h3>

<p>下記、環境変数はセットされてますよね。要確認。</p>

<ul>
<li>OS_AUTH_URL<br /></li>
<li>OS_USERNAME<br /></li>
<li>OS_PASSWORD<br /></li>
<li>OS_REGION_NAME<br /></li>
<li>OS_TENANT_NAME<br /></li>
</ul>

<h3 id="最小限の構成ファイル">最小限の構成ファイル</h3>

<script type="text/javascript" src="http://gist.github.com/977209064bcfda66d085.js"></script>

<p>これだけ。Providerの設定は書かなくていいです。Terraformは環境変数を見に行きます。Resource部は、最小限ということで、まずはインスタンスを起動し、Floating IPをつけるとこまで持っていきましょう。</p>

<h3 id="さあ実行">さあ実行</h3>

<p>まずはterraform planコマンドで、実行計画を確認します。</p>

<pre><code>$ terraform plan
Refreshing Terraform state prior to plan...


The Terraform execution plan has been generated and is shown below.
Resources are shown in alphabetical order for quick scanning. Green resources
will be created (or destroyed and then created if an existing resource exists), yellow resources are being changed in-place, and red resources will be destroyed.

Note: You didn't specify an &quot;-out&quot; parameter to save this plan, so when &quot;apply&quot; is called, Terraform can't guarantee this is what will execute.

+ openstack_compute_instance_v2.sample-server
    access_ip_v4:      &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;
    access_ip_v6:      &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;
    flavor_id:         &quot;&quot; =&gt; &quot;my_flavor_id&quot;
    flavor_name:       &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;
    floating_ip:       &quot;&quot; =&gt; &quot;aaa.bbb.ccc.ddd&quot;
    image_id:          &quot;&quot; =&gt; &quot;my_image_id&quot;
    image_name:        &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;
    key_pair:          &quot;&quot; =&gt; &quot;my_keypair&quot;
    name:              &quot;&quot; =&gt; &quot;tf-sample&quot;
    network.#:         &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;
    region:            &quot;&quot; =&gt; &quot;my_region&quot;
    security_groups.#: &quot;&quot; =&gt; &quot;1&quot;
    security_groups.0: &quot;&quot; =&gt; &quot;my_sg&quot;
</code></pre>

<p>定義通りに動きそうですね。では実行。applyです。</p>

<pre><code>$ terraform apply  
openstack_compute_instance_v2.sample-server: Creating...  
    access_ip_v4:      &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;  
    access_ip_v6:      &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;  
    flavor_id:         &quot;&quot; =&gt; &quot;my_flavor&quot;  
    flavor_name:       &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;  
    floating_ip:       &quot;&quot; =&gt; &quot;aaa.bbb.ccc.ddd&quot;  
    image_id:          &quot;&quot; =&gt; &quot;my_image_id&quot;  
    image_name:        &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;  
    key_pair:          &quot;&quot; =&gt; &quot;my_keypair&quot;  
    name:              &quot;&quot; =&gt; &quot;tf-sample&quot;  
    network.#:         &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;  
    region:            &quot;&quot; =&gt; &quot;my_region&quot;
    security_groups.#: &quot;&quot; =&gt; &quot;1&quot;
    security_groups.0: &quot;&quot; =&gt; &quot;my_sg&quot;
openstack_compute_instance_v2.test-server: Creation complete

Apply complete! Resources: 1 added, 0 changed, 0 destroyed.

The state of your infrastructure has been saved to the path below. This state is required to modify and destroy your infrastructure, so keep it safe. To inspect the complete state use the `terraform show` command.
</code></pre>

<p>とても楽ちんですね。あとはオプションを追加して込み入った構成に挑戦してみてください。</p>

                    </div>
                </section>
                
            </div>
            
<div class="pagination">
  <nav role="pagination" class="post-list-pagination">
      
      <a href="/tags/terraform/page/2/" class="post-list-pagination-item pure-button post-list-pagination-item-prev">
        <i class="fa fa-angle-double-left"></i>&nbsp;Newer
      </a>
      
    <span class="post-list-pagination-item post-list-pagination-item-current">Page 3 of 3</span>
    
  </nav>
</div>


            <div class="footer">
    <div class="pure-menu pure-menu-horizontal pure-menu-open">
        <ul>
            <li>Powered by <a class="hugo" href="http://hugo.spf13.com/" target="_blank">hugo</a></li>
        </ul>
    </div>
</div>
<script src="https://ToruMakabe.github.io//js/all.min.js"></script>
        </div>
    </div>
</div>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', '', 'auto');
ga('send', 'pageview');

</script>

</body>
</html>
